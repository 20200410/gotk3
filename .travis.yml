language: go

go:
  - 1.3
  - 1.4
  - tip

env:
  - GOARCH=amd64

sudo: required
dist: trusty

before_install:
  - sudo apt-get update -qq
  - sudo apt-get install -qq -y gtk+3.0 libgtk-3-dev
  - sudo apt-get install -qq -y xvfb
  - "export DISPLAY=:99.0"
  - sudo /usr/bin/Xvfb $DISPLAY 2>1 > /dev/null &

script:
  - GTK_VERSION=$(pkg-config --modversion gtk+-3.0 | tr . _| cut -d '_' -f 1-2)
  - echo "GTK version ${GTK_VERSION}"
  - go test -tags "gtk_${GTK_VERSION}" github.com/gotk3/gotk3/...